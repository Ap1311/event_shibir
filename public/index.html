<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Event Dashboard</title>
    <link rel="icon" type="image/x-icon" href="event.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="style.css">
    
</head>
<body>

    <div class="offcanvas offcanvas-start bg-white text-dark shadow-lg" data-bs-scroll="true" tabindex="-1" id="sidebar">
        <div class="offcanvas-header border-bottom">
            <a class="navbar-brand text-dark d-flex align-items-center" href="#">
                <img src="event.ico" alt="Event Logo" class="me-2 header-brand-icon" style="width:27px; height:27px; vertical-align:middle;">
                <span class="header-brand-text">Event Dashboard</span>
            </a>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body d-flex flex-column">
            <ul class="nav nav-pills flex-column mb-auto" id="myTab" role="tablist">
                <li class="nav-item" role="presentation"><button class="nav-link text-start active" id="dashboard-tab" data-bs-toggle="tab" data-bs-target="#dashboard" type="button" role="tab"><i class="bi bi-grid-1x2-fill me-2"></i>Dashboard</button></li>
                <li class="nav-item" role="presentation"><button class="nav-link text-start" id="create-candidate-tab" data-bs-toggle="tab" data-bs-target="#create-candidate" type="button" role="tab"><i class="bi bi-person-plus-fill me-2"></i>Create Candidate</button></li>
                <li class="nav-item" role="presentation"><button class="nav-link text-start" id="view-candidate-tab" data-bs-toggle="tab" data-bs-target="#view-candidate" type="button" role="tab"><i class="bi bi-person-lines-fill me-2"></i>View Candidate</button></li>
                <li class="nav-item" role="presentation"><button class="nav-link text-start" id="all-candidates-tab" data-bs-toggle="tab" data-bs-target="#all-candidates" type="button" role="tab"><i class="bi bi-people-fill me-2"></i>All Candidates</button></li>
                <li class="nav-item" role="presentation"><button class="nav-link text-start" id="add-points-tab" data-bs-toggle="tab" data-bs-target="#add-points" type="button" role="tab"><i class="bi bi-plus-circle-dotted me-2"></i>Add Points</button></li>
                <li class="nav-item" role="presentation"><button class="nav-link text-start" id="event-points-tab" data-bs-toggle="tab" data-bs-target="#event-points" type="button" role="tab"><i class="bi bi-award-fill me-2"></i>Event Points</button></li>
                <li class="nav-item" role="presentation"><button class="nav-link text-start" id="attendance-tab" data-bs-toggle="tab" data-bs-target="#attendance" type="button" role="tab"><i class="bi bi-check-circle-fill me-2"></i>Attendance</button></li>
                <li class="nav-item" role="presentation"><button class="nav-link text-start" id="bulk-attendance-tab" data-bs-toggle="tab" data-bs-target="#bulk-attendance" type="button" role="tab"><i class="bi bi-check-all me-2"></i>Bulk Attend</button></li>
                <hr>
                <li class="nav-item"><a href="/api/backup/excel" class="nav-link text-start text-success"><i class="bi bi-cloud-download-fill me-2"></i>Download Backup</a></li>
            </ul>
            <hr>
            <div class="mt-auto">
                 <p class="text-muted small mb-1">Logged in as:</p>
                 <p class="fw-bold" id="loggedInUsername">Loading...</p>
                 <button class="btn btn-outline-danger w-100" id="logoutButton">
                     <i class="bi bi-box-arrow-right me-2"></i>Logout
                 </button>
            </div>
        </div>
    </div>

    <header id="main-header" class="navbar navbar-light bg-white sticky-top shadow-sm border-bottom">
        <div class="container-fluid d-flex align-items-center justify-content-between">
          <div class="d-flex align-items-center header-left">
            <button
              class="btn header-menu-btn d-flex align-items-center justify-content-center me-3"
              type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebar" aria-controls="sidebar" aria-label="Toggle sidebar">
              <i class="bi bi-list fs-3"></i>
            </button>
            <a class="navbar-brand d-flex align-items-center mb-0" href="#">
              <img src="event.ico" alt="Event Logo" class="me-2 header-brand-icon" style="width:27px; height:27px; vertical-align:middle;">
              <span class="header-brand-text">Event Dashboard</span>
            </a>
          </div>
          <div class="d-flex align-items-center header-right"></div>
        </div>
      </header>


    <main class="container pb-4">
        <div class="tab-content" id="myTabContent">

            <div class="tab-pane fade show active" id="dashboard" role="tabpanel">
                <h3 class="mb-3 pt-4">Dashboard</h3>
                <div class="row" id="stat-cards">
                    <div class="col-lg-4 mb-3"><div class="card stat-card shadow-sm border-0 text-white bg-primary"><div class="card-body"><h5 class="card-title"><i class="bi bi-people-fill me-2"></i>Total Candidates</h5><p class="card-text fs-2" id="stat-total-candidates">0</p></div></div></div>
                    <div class="col-lg-4 mb-3"><div class="card stat-card shadow-sm border-0 text-white bg-success"><div class="card-body"><h5 class="card-title"><i class="bi bi-star-fill me-2"></i>Total Points Awarded</h5><p class="card-text fs-2" id="stat-total-points">0</p></div></div></div>
                    <div class="col-lg-4 mb-3"><div class="card stat-card shadow-sm border-0 text-white bg-info"><div class="card-body"><h5 class="card-title"><i class="bi bi-check-circle-fill me-2"></i>Total Attendance Marks</h5><p class="card-text fs-2" id="stat-total-attendance">0</p></div></div></div>
                </div>
                <div class="row">
                    <div class="col-lg-8 mb-3"><div class="card shadow-sm border-0"><div class="card-body"><h5 class="card-title">Points Awarded (Last 7 Days)</h5><canvas id="pointsBarChart"></canvas></div></div></div>
                    <div class="col-lg-4 mb-3"><div class="card shadow-sm border-0"><div class="card-body"><h5 class="card-title">Top 3 Users</h5><ul class="list-group list-group-flush" id="top-users-list"></ul></div></div></div>
                </div>
                <div class="row"><div class="col-12 mb-3"><div class="card shadow-sm border-0"><div class="card-body"><h5 class="card-title">Recent Activity</h5><ul class="list-group list-group-flush" id="activity-feed"></ul></div></div></div></div>
            </div>

            <div class="tab-pane fade" id="create-candidate" role="tabpanel">
                <h3 class="mb-3 pt-4">Register a New Candidate</h3>
                <div class="alert-placeholder"></div>
                <div class="card shadow-sm border-0"><div class="card-body">
                <form id="createCandidateForm">
                    <div class="mb-3"><label for="name" class="form-label">Full Name</label><input type="text" class="form-control" id="name" required></div>
                    <div class="mb-3"><label for="age" class="form-label">Age</label><input type="number" class="form-control" id="age" required></div>
                    <div class="mb-3"><label for="phone" class="form-label">Phone Number</label><input type="tel" class="form-control" id="phone" required></div>
                    <div class="mb-3"><label for="gender" class="form-label">Gender</label><select class="form-select" id="gender"><option>Male</option><option>Female</option></select></div>
                    <button type="submit" class="btn btn-primary"><i class="bi bi-person-plus me-2"></i>Create Candidate</button>
                </form></div></div>
            </div>

            <div class="tab-pane fade" id="view-candidate" role="tabpanel">
                <h3 class="mb-3 pt-4">Find a Candidate</h3>
                <div class="alert-placeholder"></div>
                <form id="viewCandidateForm" class="d-flex mb-3"><input class="form-control me-2" type="search" id="searchTerm" placeholder="Enter UID or Name" required><button class="btn btn-success" type="submit"><i class="bi bi-search me-2"></i>Search</button></form>
                <div id="candidateDetails" class="mt-4"></div>
            </div>

             <div class="tab-pane fade" id="all-candidates" role="tabpanel">
                <h3 class="mb-3 pt-4">All Candidates</h3>
                <div class="card shadow-sm border-0 mb-3 filter-card">
                    <div class="card-body">
                        <div class="row g-3 align-items-end">
                            <div class="col-md-4"><label for="filterGender" class="form-label">Gender</label><select id="filterGender" class="form-select"><option value="all">All Genders</option><option value="Male">Male</option><option value="Female">Female</option></select></div>
                            <div class="col-md-4"><label for="filterSort" class="form-label">Sort By</label><select id="filterSort" class="form-select"><option value="uid">UID</option><option value="name">Name</option><option value="total_points">Total Points</option><option value="today_points">Today's Points</option></select></div>
                            <div class="col-md-4"><label for="filterSearch" class="form-label">Search Name/UID</label><input type="text" id="filterSearch" class="form-control" placeholder="Type to search..."></div>
                        </div>
                    </div>
                </div>
                <div class="card shadow-sm border-0">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover mb-0">
                            <thead class="table-light"><tr><th scope="col">UID</th><th scope="col">Name</th><th scope="col">Phone</th><th scope="col">Gender</th><th scope="col">Today's</th><th scope="col">Total</th></tr></thead>
                            <tbody id="allCandidatesBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="tab-pane fade" id="add-points" role="tabpanel">
                <h3 class="mb-3 pt-4">Add Points Manually</h3>
                <div class="alert-placeholder"></div>
                <div class="card shadow-sm border-0"><div class="card-body">
                <form id="addPointsForm"><div class="mb-3"><label for="addPointsUid" class="form-label">Candidate UID</label><input type="number" class="form-control" id="addPointsUid" required></div><div class="mb-3"><label for="points" class="form-label">Points</label><input type="number" class="form-control" id="points" required></div><div class="mb-3"><label for="reason" class="form-label">Reason</label><input type="text" class="form-control" id="reason" placeholder="e.g., Quiz Winner" required></div><button type="submit" class="btn btn-primary"><i class="bi bi-plus-lg me-2"></i>Add Points</button></form>
                </div></div>
            </div>

            <div class="tab-pane fade" id="event-points" role="tabpanel">
                <h3 class="mb-3 pt-4">Award Points for an Event</h3>
                <div class="alert-placeholder"></div>
                <div class="card shadow-sm border-0"><div class="card-body">
                <p class="card-subtitle mb-2 text-muted">Quickly add the same points to multiple candidates.</p>
                <form id="eventPointsForm"><div class="mb-3"><label for="eventName" class="form-label">Event Name</label><input type="text" class="form-control" id="eventName" placeholder="e.g., Treasure Hunt Participation" required></div><div class="mb-3"><label for="eventPoints" class="form-label">Points per Candidate</label><input type="number" class="form-control" id="eventPoints" required></div><div class="mb-3"><label for="eventUids" class="form-label">Candidate UIDs</label><textarea class="form-control" id="eventUids" rows="5"></textarea></div><button type="submit" class="btn btn-primary"><i class="bi bi-award me-2"></i>Award Points</button></form>
                </div></div>
            </div>

            <div class="tab-pane fade" id="attendance" role="tabpanel">
                <h3 class="mb-3 pt-4">Mark Single Attendance (100 Points)</h3>
                <div class="alert-placeholder"></div>
                <div class="card shadow-sm border-0"><div class="card-body">
                <form id="attendanceForm"><div class="mb-3"><label for="attendanceUid" class="form-label">Candidate UID</label><input type="number" class="form-control" id="attendanceUid" required></div><div class="mb-3"><label for="eventDay" class="form-label">Event Day</label><select class="form-select" id="eventDay"><option value="1">Day 1</option><option value="2">Day 2</option><option value="3">Day 3</option><option value="4">Day 4</option><option value="5">Day 5</option></select></div><button type="submit" class="btn btn-primary"><i class="bi bi-check-lg me-2"></i>Mark Present</button></form>
                </div></div>
            </div>

            <div class="tab-pane fade" id="bulk-attendance" role="tabpanel">
                <h3 class="mb-3 pt-4">Mark Bulk Attendance (100 Points)</h3>
                <div class="alert-placeholder"></div>
                <div class="card shadow-sm border-0"><div class="card-body">
                <form id="bulkAttendanceForm"><div class="mb-3"><label for="bulkEventDay" class="form-label">Event Day</label><select class="form-select" id="bulkEventDay"><option value="1">Day 1</option><option value="2">Day 2</option><option value="3">Day 3</option><option value="4">Day 4</option><option value="5">Day 5</option></select></div><div class="mb-3"><label for="bulkEventUids" class="form-label">Candidate UIDs</label><textarea class="form-control" id="bulkEventUids" rows="5" required></textarea></div><button type="submit" class="btn btn-primary"><i class="bi bi-check-all me-2"></i>Mark All Present</button></form>
                </div></div>
            </div>

        </div> </main>

    <footer class="fixed-bottom bg-white text-dark-50 p-3 text-center shadow-lg border-top">
        &copy; 2025 Powered by Aarav Programmers <a href="https://www.linkedin.com/in/aaravshah1311" target="_blank" class="footer-link ms-2">
            <i class="bi bi-linkedin"></i>
        </a>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
</body>
</html>